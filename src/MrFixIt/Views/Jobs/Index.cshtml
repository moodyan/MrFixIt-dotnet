@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Title = "Mr Fix-It Jobs";
}



<div class="text-center">
    <h3>Our Current Jobs</h3>
    @Html.ActionLink("Add a new job", "Create")
</div>

@foreach (var job in Model)
{
    <script type="text/javascript">
    $(document).ready(function () {
        $('#@job.JobId').click(function () {
            $.ajax({
                type: 'GET',
                dataType: 'html',
                url: '@Url.Action("Claim")',
                data: { id: $(this).data('id'), text: $(this).data('job') },
                success: function (result) {
                    $('.@job.JobId').html(result).toggle();
                }
            });
            console.log('confirm-claim-' + $(this).data('id'));
        });
    });
    </script>
    <ul>
        <li>@job.Title</li>
        <ul>
            <li>@job.Description</li>
        </ul>
       
            @if (job.Worker == null)
            {
            <p>This job is unclaimed.</p> 
                @if (ViewBag.Worker != null)
                {
                    <button class="btn claim-button" text=@job.Title data-id=@job.JobId id="@job.JobId">Claim This Job</button>
                    <div class="@job.JobId"></div>
                }
            }
            else
            {
                <p>This Job is claimed by @job.Worker.FirstName @job.Worker.LastName</p>
            }
    </ul>
    <hr />
}

